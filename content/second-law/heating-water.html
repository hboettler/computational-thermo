

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Water heating &#8212; Computational Thermodynamics</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0-alpha.0/dist/embed.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script async="async" src="../../_static/thebelab.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Turbine isentropic efficiency" href="turbine-efficiency.html" />
    <link rel="prev" title="Vortex tube" href="vortex-tube.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          

<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Computational Thermodynamics</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search the docs ..." aria-label="Search the docs ..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../intro.html">Computational Thermodynamics</a>
  </li>
  <li class="">
    <a href="../getting-started.html">Getting started</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="../setting-up-environment.html">Setting up your computing environment</a>
    </li>
    <li class="">
      <a href="../intro-solving-problems.html">Solving thermodynamics problems</a>
    </li>
    <li class="">
      <a href="../intro-using-coolprop.html">Using CoolProp</a>
    </li>
    <li class="">
      <a href="../using-scipy.html">Using NumPy and SciPy modules</a>
    </li>
  </ul>
  </li>
<li class="navbar-special">
<p class="margin-caption">Modules</p>
</li>
  <li class="">
    <a href="../first-law/first-law.html">First Law of Thermodynamics</a>
  </li>
  <li class="active">
    <a href="second-law.html">Second Law of Thermodynamics</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="vortex-tube.html">Vortex tube</a>
    </li>
    <li class="active">
      <a href="">Water heating</a>
    </li>
    <li class="">
      <a href="turbine-efficiency.html">Turbine isentropic efficiency</a>
    </li>
    <li class="">
      <a href="solar-powered-pump.html">Solar-powered pump</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../exergy/exergy.html">Exergy</a>
  </li>
  <li class="">
    <a href="../properties-pure/properties-pure.html">Properties of Pure Fluids</a>
  </li>
  <li class="">
    <a href="../mixtures/mixtures.html">Mixture properties</a>
  </li>
  <li class="">
    <a href="../combustion/combustion.html">Combustion</a>
  </li>
  <li class="">
    <a href="../chemical-equilibrium/chemical-equilibrium.html">Chemical Equilibrium</a>
  </li>
  <li class="">
    <a href="../stat-thermo/stat-thermo.html">Statistical Thermodynamics</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Reference</p>
</li>
  <li class="">
    <a href="../zbibliography.html">Bibliography</a>
  </li>
  <li class="">
    <a href="../contributing.html">Contributing to this book</a>
  </li>
</ul>
</nav>
<p class="navbar_footer">Powered by <a href="https://jupyterbook.org">Jupyter Book</a></p>
</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../../_sources/content/second-law/heating-water.ipynb.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/kyleniemeyer/computational-thermo/newbackend?urlpath=tree/book/content/second-law/heating-water.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="../../_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                <button type="button" class="btn btn-secondary topbarbtn thebelab-launch-button" onclick="initThebelab()" title="Launch Thebelab" data-toggle="tooltip" data-placement="left"><i class="fas fa-rocket"></i><span style="margin-left: .4em;">ThebeLab</span></button>
                
            </div>
        </div>
        

        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#find-final-temperature-and-pressure" class="nav-link">Find final temperature and pressure</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#find-electrical-work-required" class="nav-link">Find electrical work required</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#find-entropy-change" class="nav-link">Find entropy change</a>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#plot-the-state-points-for-water" class="nav-link">Plot the state points for water</a>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="water-heating">
<h1>Water heating<a class="headerlink" href="#water-heating" title="Permalink to this headline">¶</a></h1>
<p>An insulated, rigid tank contains 4 kg of water at 100 kPa, where initially 0.25 of the mass is liquid. An electric heater turns on and operates until all of the liquid has vaporized. (Neglect the heat capacity of the tank and heater.)</p>
<p><img alt="Water heater" src="../../_images/water-heater.png" /></p>
<p><strong>Problem:</strong></p>
<ul class="simple">
<li><p>Determine the final temperature and pressure of the water.</p></li>
<li><p>Determine the electrical work required by this process.</p></li>
<li><p>Determine the total change in entropy associated with this process.</p></li>
<li><p>Plot the state points for the water on a temperature-specific entropy diagram.</p></li>
</ul>
<p>First, load the necessary modules and specify the known/initial conditions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="o">%</span><span class="n">matplotlib</span> <span class="n">inline</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cantera</span> <span class="k">as</span> <span class="nn">ct</span>

<span class="kn">from</span> <span class="nn">IPython.display</span> <span class="kn">import</span> <span class="n">set_matplotlib_formats</span>
<span class="n">set_matplotlib_formats</span><span class="p">(</span><span class="s1">&#39;pdf&#39;</span><span class="p">,</span> <span class="s1">&#39;png&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;savefig.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">150</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span><span class="o">=</span> <span class="mi">150</span>

<span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">Q_</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mass</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s1">&#39;kg&#39;</span><span class="p">)</span>
<span class="n">pressure_initial</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;kPa&#39;</span><span class="p">)</span>
<span class="n">quality_initial</span> <span class="o">=</span> <span class="mf">0.25</span>

<span class="n">quality_final</span> <span class="o">=</span> <span class="mf">1.0</span>

<span class="c1"># specify the initial state using pressure and quality</span>
<span class="n">state_initial</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>
<span class="n">state_initial</span><span class="o">.</span><span class="n">PX</span> <span class="o">=</span> <span class="n">pressure_initial</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">quality_initial</span>
<span class="n">state_initial</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>
  water:

       temperature         372.809  K
          pressure          100000  Pa
           density         2.35669  kg/m^3
  mean mol. weight          18.016  amu
    vapor fraction            0.25

                          1 kg            1 kmol
                       -----------      ------------
          enthalpy    -1.49887e+07         -2.7e+08     J
   internal energy    -1.50312e+07       -2.708e+08     J
           entropy         6337.06        1.142e+05     J/K
    Gibbs function    -1.73512e+07       -3.126e+08     J
 heat capacity c_p    inf              inf              J/K
 heat capacity c_v         20936.9        3.772e+05     J/K

</pre></div>
</div>
</div>
</div>
<div class="section" id="find-final-temperature-and-pressure">
<h2>Find final temperature and pressure<a class="headerlink" href="#find-final-temperature-and-pressure" title="Permalink to this headline">¶</a></h2>
<p>Due to conservation of mass, since the mass and volume of the system are fixed, the specific volume and density must be constant:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
v_2 = v_1 \\
\rho_2 = \rho_1
\end{split}\]</div>
<p>Therefore the final state is fixed by the density and quality, where <span class="math notranslate nohighlight">\(x_2 = 1\)</span>:</p>
<div class="cell tag_raises-exception docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">state_final</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>
<span class="n">state_final</span><span class="o">.</span><span class="n">DX</span> <span class="o">=</span> <span class="n">state_initial</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="n">quality_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">AttributeError</span><span class="g g-Whitespace">                            </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">3</span><span class="o">-</span><span class="mf">845410e31</span><span class="n">b81</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">1</span> <span class="n">state_final</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>
<span class="ne">----&gt; </span><span class="mi">2</span> <span class="n">state_final</span><span class="o">.</span><span class="n">DX</span> <span class="o">=</span> <span class="n">state_initial</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="n">quality_final</span>

<span class="ne">AttributeError</span>: &#39;cantera._cantera.PureFluid&#39; object has no attribute &#39;DX&#39;
</pre></div>
</div>
</div>
</div>
<p>Hmm, what happened here? It looks like Cantera unfortunately does not support specifying the thermodynamic state using density and quality. (With quality as one property, it only supports temperature or pressure as the other property.)</p>
<p>Fortunately, CoolProp <em>does</em> support specifying the state the way we need to solve this problem, so let’s use that for the final state:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">CoolProp.CoolProp</span> <span class="kn">import</span> <span class="n">PropsSI</span>

<span class="n">temp_final</span> <span class="o">=</span> <span class="n">PropsSI</span><span class="p">(</span>
    <span class="s1">&#39;T&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">state_initial</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="n">quality_final</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span>
    <span class="p">)</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">kelvin</span>
<span class="n">pres_final</span> <span class="o">=</span> <span class="n">PropsSI</span><span class="p">(</span>
    <span class="s1">&#39;P&#39;</span><span class="p">,</span> <span class="s1">&#39;D&#39;</span><span class="p">,</span> <span class="n">state_initial</span><span class="o">.</span><span class="n">density</span><span class="p">,</span> <span class="s1">&#39;Q&#39;</span><span class="p">,</span> <span class="n">quality_final</span><span class="p">,</span> <span class="s1">&#39;water&#39;</span>
    <span class="p">)</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">pascal</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Final temperature: </span><span class="si">{</span><span class="n">temp_final</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Final pressure: </span><span class="si">{</span><span class="n">pres_final</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># We can then set the final state using the Cantera object,</span>
<span class="c1"># now that we know temperature</span>
<span class="n">state_final</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>
<span class="n">state_final</span><span class="o">.</span><span class="n">TX</span> <span class="o">=</span> <span class="n">temp_final</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">quality_final</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Final temperature: 420.08 kelvin
Final pressure: 438257.38 pascal
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="find-electrical-work-required">
<h2>Find electrical work required<a class="headerlink" href="#find-electrical-work-required" title="Permalink to this headline">¶</a></h2>
<p>To find the work required, we can do an energy balance on the (closed) system:
\begin{equation}
W_{\text{in}} = m (u_2 - u_1)
\end{equation}</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">work</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="n">state_final</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">Q_</span><span class="p">(</span><span class="n">state_initial</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Electrical work required: </span><span class="si">{</span><span class="n">work</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">ureg</span><span class="o">.</span><span class="n">megajoule</span><span class="p">)</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Electrical work required: 6.47 megajoule
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="find-entropy-change">
<h2>Find entropy change<a class="headerlink" href="#find-entropy-change" title="Permalink to this headline">¶</a></h2>
<p>The total entropy change is the change in entropy of the system plus that of the surroundings:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\Delta S_{\text{total}} = \Delta S_{\text{system}} + \Delta S_{\text{surr}} \\
\Delta S_{\text{total}} = \Delta S_{\text{system}} = m (s_2 - s_1)
\end{split}\]</div>
<p>since the entropy change of the surroundings is zero.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">entropy_change</span> <span class="o">=</span> <span class="n">mass</span> <span class="o">*</span> <span class="p">(</span><span class="n">Q_</span><span class="p">(</span><span class="n">state_final</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">)</span> <span class="o">-</span> <span class="n">Q_</span><span class="p">(</span><span class="n">state_initial</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Entropy change: </span><span class="si">{</span><span class="n">entropy_change</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Entropy change: 16195.98 joule
</pre></div>
</div>
</div>
</div>
<p>This process is irreversible, associated with a positive increase in total entropy.</p>
</div>
<div class="section" id="plot-the-state-points-for-water">
<h2>Plot the state points for water<a class="headerlink" href="#plot-the-state-points-for-water" title="Permalink to this headline">¶</a></h2>
<p>We can construct the saturated liquid and saturated vapor lines in a temperature–specific entropy diagram (T–s diagram), and then plot the initial and final states locations along with the process line (of constant density):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>

<span class="c1"># Array of temperatures from fluid minimum temperature to critical temperature</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">min_temp</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">critical_temperature</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">get_sat_entropy_fluid</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Gets entropy for temperature along saturated liquid line&#39;&#39;&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">TX</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span> <span class="mf">0.0</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">s</span>
<span class="k">def</span> <span class="nf">get_sat_entropy_gas</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Gets entropy for temperature along saturated vapor line&#39;&#39;&#39;</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">TX</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span> <span class="mf">1.0</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">s</span>

<span class="c1"># calculate entropy values associated with temperatures along</span>
<span class="c1"># saturation lines</span>
<span class="n">entropies_f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">get_sat_entropy_fluid</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">])</span>
<span class="n">entropies_g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">get_sat_entropy_gas</span><span class="p">(</span><span class="n">T</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">])</span>

<span class="c1"># critical point</span>
<span class="n">f</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">critical_temperature</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">critical_pressure</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Plot the saturated liquid line, critical point,</span>
<span class="c1"># and saturated vapor line</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_f</span><span class="p">,</span> <span class="n">temps</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies_g</span><span class="p">,</span> <span class="n">temps</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;o&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Specific entropy (J/kg⋅K)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>

<span class="c1"># Plot the initial and final states, and label them</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">state_initial</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">state_initial</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;(1)&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">state_initial</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">state_initial</span><span class="o">.</span><span class="n">T</span><span class="p">),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">20</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span>
            <span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">state_final</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">state_final</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;s&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">annotate</span><span class="p">(</span><span class="s1">&#39;(2)&#39;</span><span class="p">,</span> <span class="n">xy</span><span class="o">=</span><span class="p">(</span><span class="n">state_final</span><span class="o">.</span><span class="n">s</span><span class="p">,</span> <span class="n">state_final</span><span class="o">.</span><span class="n">T</span><span class="p">),</span>
            <span class="n">xytext</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">textcoords</span><span class="o">=</span><span class="s1">&#39;offset points&#39;</span><span class="p">,</span>
            <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">va</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span>
            <span class="p">)</span>

<span class="c1"># show process line of constant density</span>
<span class="n">temps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">state_initial</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">state_final</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">get_entrophy</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">density</span><span class="p">):</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>
    <span class="n">f</span><span class="o">.</span><span class="n">TD</span> <span class="o">=</span> <span class="n">T</span><span class="p">,</span> <span class="n">density</span>
    <span class="k">return</span> <span class="n">f</span><span class="o">.</span><span class="n">s</span>
<span class="n">entropies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">get_entrophy</span><span class="p">(</span><span class="n">T</span><span class="p">,</span> <span class="n">state_initial</span><span class="o">.</span><span class="n">density</span><span class="p">)</span> <span class="k">for</span> <span class="n">T</span> <span class="ow">in</span> <span class="n">temps</span><span class="p">])</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">entropies</span><span class="p">,</span> <span class="n">temps</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../../_images/heating-water_14_0.png" src="../../_images/heating-water_14_0.png" />
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kyleniemeyer/computational-thermo",
            ref: "newbackend",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "content/second-law"
        }
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="vortex-tube.html" title="previous page">Vortex tube</a>
    <a class='right-next' id="next-link" href="turbine-efficiency.html" title="next page">Turbine isentropic efficiency</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kyle Niemeyer<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>