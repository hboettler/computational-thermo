

<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Second Law efficiency of a furnace &#8212; Computational Thermodynamics</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/all.min.css" integrity="sha384-KA6wR/X5RY4zFAHpv/CnoG2UW1uogYfdnP67Uv7eULvTveboZJg0qUpmJZb5VqzN" crossorigin="anonymous">
    <link href="../../_static/css/index.css" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/sphinx-book-theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/jupyter-sphinx.css" />
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script src="../../_static/language_data.js"></script>
    <script src="../../_static/togglebutton.js"></script>
    <script src="../../_static/clipboard.min.js"></script>
    <script src="../../_static/copybutton.js"></script>
    <script src="../../_static/mystnb.js"></script>
    <script src="../../_static/sphinx-book-theme.js"></script>
    <script >var togglebuttonSelector = '.toggle, .secondtoggle, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0-alpha.0/dist/embed-amd.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script async="async" src="../../_static/thebelab.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Chemical Equilibrium" href="../chemical-equilibrium/chemical-equilibrium.html" />
    <link rel="prev" title="Adiabatic flame temperature" href="adiabatic-flame-temperature.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="docsearch:language" content="en">



  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../../index.html">
  
  <img src="../../_static/logo.png" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Computational Thermodynamics</h1>
  
</a>
</div>

<form class="bd-search d-flex align-items-center" action="../../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>

<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
  
  <ul class="nav sidenav_l1">
  <li class="">
    <a href="../intro.html">Computational Thermodynamics</a>
  </li>
  <li class="">
    <a href="../getting-started.html">Getting started</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="../setting-up-environment.html">Setting up your computing environment</a>
    </li>
    <li class="">
      <a href="../intro-solving-problems.html">Solving thermodynamics problems</a>
    </li>
    <li class="">
      <a href="../intro-using-coolprop.html">Using CoolProp</a>
    </li>
    <li class="">
      <a href="../using-scipy.html">Using NumPy and SciPy modules</a>
    </li>
  </ul>
  </li>
<li class="navbar-special">
<p class="margin-caption">Modules</p>
</li>
  <li class="">
    <a href="../first-law/first-law.html">First Law of Thermodynamics</a>
  </li>
  <li class="">
    <a href="../second-law/second-law.html">Second Law of Thermodynamics</a>
  </li>
  <li class="">
    <a href="../exergy/exergy.html">Exergy</a>
  </li>
  <li class="">
    <a href="../properties-pure/properties-pure.html">Properties of Pure Fluids</a>
  </li>
  <li class="">
    <a href="../mixtures/mixtures.html">Mixture properties</a>
  </li>
  <li class="active">
    <a href="combustion.html">Combustion</a>
  <ul class="nav sidenav_l2">
    <li class="">
      <a href="adiabatic-flame-temperature.html">Adiabatic flame temperature</a>
    </li>
    <li class="active">
      <a href="">Second Law efficiency of a furnace</a>
    </li>
  </ul>
  </li>
  <li class="">
    <a href="../chemical-equilibrium/chemical-equilibrium.html">Chemical Equilibrium</a>
  </li>
  <li class="">
    <a href="../stat-thermo/stat-thermo.html">Statistical Thermodynamics</a>
  </li>
<li class="navbar-special">
<p class="margin-caption">Reference</p>
</li>
  <li class="">
    <a href="../zbibliography.html">Bibliography</a>
  </li>
  <li class="">
    <a href="../contributing.html">Contributing to this book</a>
  </li>
</ul>
</nav>

 <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse" data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu" aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation" title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i class="fas fa-download"></i></button>

            
            <div class="dropdown-buttons">
                <!-- ipynb file if we had a myst markdown file -->
                
                <!-- Download raw file -->
                <a class="dropdown-buttons" href="../../_sources/content/combustion/furnace-efficiency.ipynb.txt"><button type="button" class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip" data-placement="left">.ipynb</button></a>
                <!-- Download PDF via print -->
                <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF" onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
            </div>
            
        </div>

        <!-- Edit this page -->
        

        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="bottom" onclick="toggleFullScreen()" title="Fullscreen mode"><i class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->
        
        <div class="dropdown-buttons-trigger">
            <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
            <div class="dropdown-buttons">
                
                <a class="binder-button" href="https://mybinder.org/v2/gh/kyleniemeyer/computational-thermo/newbackend?urlpath=tree/book/content/combustion/furnace-efficiency.ipynb"><button type="button" class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip" data-placement="left"><img class="binder-button-logo" src="../../_static/images/logo_binder.svg" alt="Interact on binder">Binder</button></a>
                
                
                <button type="button" class="btn btn-secondary topbarbtn thebelab-launch-button" onclick="initThebelab()" title="Launch Thebelab" data-toggle="tooltip" data-placement="left"><i class="fas fa-rocket"></i><span style="margin-left: .4em;">ThebeLab</span></button>
                
            </div>
        </div>
        
    </div>
    <div class="d-none d-md-block col-md-2 bd-toc show">
<div class="tocsection onthispage pt-5 pb-3">
    <i class="fas fa-list"></i> On this page
</div>

<nav id="bd-toc-nav">
    <ul class="nav section-nav flex-column">
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#first-law-efficiency" class="nav-link">First Law efficiency</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#reaction-stoichiometry" class="nav-link">Reaction stoichiometry</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#calculate-enthalpies" class="nav-link">Calculate enthalpies</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#calculate-enthalpies-using-mixture-object" class="nav-link">Calculate enthalpies using mixture object</a>
        </li>
    
        <li class="nav-item toc-entry toc-h3">
            <a href="#calculate-efficiency" class="nav-link">Calculate efficiency</a>
        </li>
    
            </ul>
        </li>
    
        <li class="nav-item toc-entry toc-h2">
            <a href="#second-law-efficiency" class="nav-link">Second Law efficiency</a><ul class="nav section-nav flex-column">
                
        <li class="nav-item toc-entry toc-h3">
            <a href="#exergy-of-a-fuel" class="nav-link">Exergy of a fuel</a>
        </li>
    
            </ul>
        </li>
    
    </ul>
</nav>


    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="second-law-efficiency-of-a-furnace">
<h1>Second Law efficiency of a furnace<a class="headerlink" href="#second-law-efficiency-of-a-furnace" title="Permalink to this headline">¶</a></h1>
<p>A conventional furnace provides space heating to a building, as shown here:</p>
<p><img alt="Conventional furnace" src="../../_images/furnace.pdf" /></p>
<p>The furnace combusts methane with 200% excess dry air (<span class="math notranslate nohighlight">\(ea = 2\)</span>). The air and methane enter the combustor at <span class="math notranslate nohighlight">\(T_{\text{in}}\)</span> = -10°C and <span class="math notranslate nohighlight">\(P_{\text{in}}\)</span> = 1 atm.
The furnace heats the building (<span class="math notranslate nohighlight">\(Q_{\text{out}}\)</span>), which is maintained at <span class="math notranslate nohighlight">\(T_{\text{bldg}}\)</span> = 22°C. The combustion products leave at <span class="math notranslate nohighlight">\(T_{\text{out}}\)</span> = 150°C and <span class="math notranslate nohighlight">\(P_{\text{out}}\)</span> = 1 atm.</p>
<p>Assumptions: the only combustion products are carbon dioxide, water, nitrogen, and oxygen (for excess air in the reactants). The gases follow the ideal gas law.</p>
<p><strong>Problems:</strong></p>
<ul class="simple">
<li><p>Determine the First Law efficiency of the furnace based on the higher and lower heating values of the fuel.</p></li>
<li><p>Determine the Second Law efficiency of the furnace.</p></li>
</ul>
<p>This problem also demonstrates how to use <a class="reference internal" href="#using-mixture"><span class="std std-ref">Calculate enthalpies using mixture object</span></a> and how to determine the <a class="reference internal" href="#exergy-fuel"><span class="std std-ref">Exergy of a fuel</span></a>.</p>
<p>First, we should import the necessary modules and enter the given information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">cantera</span> <span class="k">as</span> <span class="nn">ct</span>
<span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">root</span>

<span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">Q_</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># for convenience:</span>
<span class="k">def</span> <span class="nf">to_si</span><span class="p">(</span><span class="n">quant</span><span class="p">):</span>
    <span class="sd">&#39;&#39;&#39;Converts a Pint Quantity to magnitude at base SI units.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">quant</span><span class="o">.</span><span class="n">to_base_units</span><span class="p">()</span><span class="o">.</span><span class="n">magnitude</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># given information</span>
<span class="n">temperature_in</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>  <span class="c1"># also dead state temperature</span>
<span class="n">pressure_in</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">)</span>  <span class="c1"># also dead state pressure</span>

<span class="n">temperature_building</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">22</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>

<span class="n">temperature_out</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="n">pressure_out</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;atm&#39;</span><span class="p">)</span>

<span class="n">excess_air</span> <span class="o">=</span> <span class="mf">2.0</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="first-law-efficiency">
<h2>First Law efficiency<a class="headerlink" href="#first-law-efficiency" title="Permalink to this headline">¶</a></h2>
<p>To calculate the First Law efficiency of the furnace, we need to determine its heat output, and also the lower and higher heating values of the fuel.</p>
<p>The heat output comes from an energy balance on the system:</p>
<div class="math notranslate nohighlight">
\[
H_{\text{reac}} = Q_{\text{out}} + H_{\text{prod}} \;,
\]</div>
<p>where <span class="math notranslate nohighlight">\(H_{\text{reac}}\)</span> and <span class="math notranslate nohighlight">\(H_{\text{prod}}\)</span> are the enthalpies of the reactants and products, respectively. To determine these enthalpy values, we need to determine the relative amounts of each component in the reactants and products.</p>
<div class="section" id="reaction-stoichiometry">
<h3>Reaction stoichiometry<a class="headerlink" href="#reaction-stoichiometry" title="Permalink to this headline">¶</a></h3>
<p>The stoichiometric reaction of methane with air is</p>
<div class="math notranslate nohighlight">
\[
\text{CH}_4 + a_s \left( 0.21 \text{O}_2 + 0.79 \text{N}2 \right) \rightarrow b_s \text{CO}_2 + c_s \text{H}_2 \text{O} + d_s \text{N}_2
\]</div>
<p>and we can solve for the unknown coefficients based on elemental balances of carbon, hydrogen, oxygen, and nitrogen:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
1 = b_s \\
4 = 2 c_s \\
a_s (0.21) 2 = 2 b_s + c_s \\
a_s (0.79) 2 = 2 d_s
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">coeffs_stoich</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">coeffs_stoich</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">coeffs_stoich</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">coeffs_stoich</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="mi">2</span> <span class="o">*</span> <span class="n">coeffs_stoich</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">coeffs_stoich</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.21</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">coeffs_stoich</span><span class="p">[</span><span class="s1">&#39;N2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coeffs_stoich</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.79</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>
</pre></div>
</div>
</div>
</div>
<p>Then, the actual reaction with excess air is</p>
<div class="math notranslate nohighlight">
\[
\text{CH}_4 + a \left( 0.21 \text{O}_2 + 0.79 \text{N}2 \right) \rightarrow b \text{CO}_2 + c \text{H}_2 \text{O} + d \text{N}_2 + e \text{O}_2
\]</div>
<p>where <span class="math notranslate nohighlight">\(a\)</span> is based on the amount of excess air, with respect to the stoichiometric amount of air:</p>
<div class="math notranslate nohighlight">
\[
a = (1 + ea) a_s
\]</div>
<p>We can also find the actual coefficients by balancing each of the elements:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
1 = b \\
4 = 2 c \\
a (0.21) 2 = 2 b + c + 2e \\
a (0.79) 2 = 2 d
\end{split}\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">coeffs</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">excess_air</span><span class="p">)</span> <span class="o">*</span> <span class="n">coeffs_stoich</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span>

<span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;O2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.21</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">-</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
<span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;N2&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.79</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">/</span> <span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Moles of reaction participants, per mole of fuel:&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">species</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">coeffs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">species</span><span class="si">}</span><span class="s1">: </span><span class="si">{</span><span class="n">value</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Moles of reaction participants, per mole of fuel:
air:  28.57
CO2:  1.00
H2O:  2.00
O2:  4.00
N2:  22.57
</pre></div>
</div>
</div>
</div>
<p>Next, to carry out the energy balance, we need to find the phase of the water in the combustion products. To do this, we can determine the dew point temperature, based on the saturation temperature of water at its partial pressure, and compare with the temperature of the products.</p>
<p>The partial pressure of water vapor in the products is</p>
<div class="math notranslate nohighlight">
\[
P_v = y_v P_{\text{out}} \;,
\]</div>
<p>where <span class="math notranslate nohighlight">\(y_v\)</span> is the mole fraction of water vapor (assuming no condensation):</p>
<div class="math notranslate nohighlight">
\[
y_v = \frac{c}{b + c + d + e} \;.
\]</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># mole fraction of water vapor (no condensation)</span>
<span class="n">mole_fraction_water</span> <span class="o">=</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span>
    <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;N2&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;O2&#39;</span><span class="p">]</span>
    <span class="p">)</span>
<span class="n">pressure_water</span> <span class="o">=</span> <span class="n">mole_fraction_water</span> <span class="o">*</span> <span class="n">pressure_out</span>

<span class="n">water</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>

<span class="c1"># saturated water vapor</span>
<span class="n">water</span><span class="o">.</span><span class="n">PX</span> <span class="o">=</span> <span class="n">to_si</span><span class="p">(</span><span class="n">pressure_water</span><span class="p">),</span> <span class="mf">1.0</span>
<span class="n">temperature_dewpoint</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">water</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Dew point temperature: </span><span class="si">{</span><span class="n">temperature_dewpoint</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Products temperature: </span><span class="si">{</span><span class="n">temperature_out</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Products temperature above dew point temperature: &#39;</span>
      <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">temperature_out</span> <span class="o">&gt;</span> <span class="n">temperature_dewpoint</span><span class="si">}</span><span class="s1">&#39;</span>
      <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Dew point temperature: 311.80 kelvin
Products temperature: 423.15 kelvin
Products temperature above dew point temperature: True
</pre></div>
</div>
</div>
</div>
<p>Since the temperature of the exhaust is higher than the dew point temperature, the water in the products is entirely in the vapor phase (i.e., superheated vapor).</p>
</div>
<div class="section" id="calculate-enthalpies">
<h3>Calculate enthalpies<a class="headerlink" href="#calculate-enthalpies" title="Permalink to this headline">¶</a></h3>
<p>Now, we can calculate the enthalpies of the reactants and products (per mole of fuel), based on the molar specific enthalpy of the components in each:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">enthalpies_reactants</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">enthalpies_products</span> <span class="o">=</span> <span class="p">{}</span>

<span class="c1"># enthalpy of reactants</span>
<span class="n">reactants</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">]</span>
<span class="n">gas</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.cti&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">reactant</span> <span class="ow">in</span> <span class="n">reactants</span><span class="p">:</span>
    <span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">to_si</span><span class="p">(</span><span class="n">temperature_in</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">pressure_in</span><span class="p">),</span> 
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">reactant</span><span class="si">}</span><span class="s1">:1.0&#39;</span>
        <span class="p">)</span>
    <span class="n">enthalpies_reactants</span><span class="p">[</span><span class="n">reactant</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">enthalpy_mole</span><span class="p">,</span> <span class="s1">&#39;J/kmol&#39;</span><span class="p">)</span>

<span class="c1"># per kmol of fuel</span>
<span class="n">enthalpy_reactants</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">enthalpies_reactants</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span>
        <span class="mf">0.21</span> <span class="o">*</span> <span class="n">enthalpies_reactants</span><span class="p">[</span><span class="s1">&#39;O2&#39;</span><span class="p">]</span> <span class="o">+</span> 
        <span class="mf">0.79</span> <span class="o">*</span> <span class="n">enthalpies_reactants</span><span class="p">[</span><span class="s1">&#39;N2&#39;</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">products</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;CO2&#39;</span><span class="p">,</span> <span class="s1">&#39;H2O&#39;</span><span class="p">,</span> <span class="s1">&#39;N2&#39;</span><span class="p">,</span> <span class="s1">&#39;O2&#39;</span><span class="p">]</span>
<span class="n">gas</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.cti&#39;</span><span class="p">)</span>

<span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">products</span><span class="p">:</span>
    <span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">to_si</span><span class="p">(</span><span class="n">temperature_out</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">pressure_out</span><span class="p">),</span> 
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s1">:1.0&#39;</span>
        <span class="p">)</span>
    <span class="n">enthalpies_products</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">enthalpy_mole</span><span class="p">,</span> <span class="s1">&#39;J/kmol&#39;</span><span class="p">)</span>

<span class="c1"># per kmol of fuel</span>
<span class="n">enthalpy_products</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span>
    <span class="n">coeffs</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">*</span> <span class="n">enthalpies_products</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">products</span>
    <span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<p>We can now calculate the heat output of the furnace, per kmol of fuel:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">heat</span> <span class="o">=</span> <span class="n">enthalpy_reactants</span> <span class="o">-</span> <span class="n">enthalpy_products</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Heat output: </span><span class="si">{</span><span class="n">heat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;MJ/kmol&quot;</span><span class="p">)</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Heat output: 661.43 megajoule / kilomole
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="calculate-enthalpies-using-mixture-object">
<span id="using-mixture"></span><h3>Calculate enthalpies using mixture object<a class="headerlink" href="#calculate-enthalpies-using-mixture-object" title="Permalink to this headline">¶</a></h3>
<p>Rather than manually calculating the enthalpy of each component of the reactants and products separately and then combining, we could also calculate the enthalpy of the reactants and products as mixtures, using a Cantera <code class="docutils literal notranslate"><span class="pre">Solution</span></code> object for each.</p>
<p>We can specify the mixture state with the temperature, pressure, and calculated numbers of moles for each component: <code class="docutils literal notranslate"><span class="pre">gas.TPX</span></code>. Then, we can get the specific enthalpy of the mixture with <code class="docutils literal notranslate"><span class="pre">gas.enthalpy_mole</span></code>.</p>
<p>However, to get the extensive enthalpy of the mixture, we need to multiply this by the number of moles of the mixture. The resulting total enthalpy will be per 1 kmol of fuel, since that was the basis for our reaction stoichiometry calculations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gas_reactants</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.cti&#39;</span><span class="p">)</span>
<span class="n">reactant_string</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s1">&#39;CH4:1.0, &#39;</span>
    <span class="sa">f</span><span class="s2">&quot;O2:</span><span class="si">{</span><span class="mf">0.21</span> <span class="o">*</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .3f</span><span class="si">}</span><span class="s2">, &quot;</span>
    <span class="sa">f</span><span class="s2">&quot;N2:</span><span class="si">{</span><span class="mf">0.79</span> <span class="o">*</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2"> .3f</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>
<span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">to_si</span><span class="p">(</span><span class="n">temperature_in</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">pressure_in</span><span class="p">),</span> <span class="n">reactant_string</span>

<span class="c1"># per 1 kmol of fuel</span>
<span class="n">moles_reactants</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span>
<span class="n">enthalpy_reactants</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">enthalpy_mole</span><span class="p">,</span> <span class="s1">&#39;J/kmol&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">moles_reactants</span>

<span class="n">gas_products</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.cti&#39;</span><span class="p">)</span>
<span class="n">product_string</span> <span class="o">=</span> <span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">sp</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">coeffs</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span><span class="si">:</span><span class="s1"> .3f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">sp</span> <span class="ow">in</span> <span class="n">products</span><span class="p">])</span>
<span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">to_si</span><span class="p">(</span><span class="n">temperature_out</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">pressure_out</span><span class="p">),</span> <span class="n">product_string</span>

<span class="c1"># per 1 kmol of fuel</span>
<span class="n">moles_products</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">coeffs</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">products</span><span class="p">])</span>
<span class="n">enthalpy_products</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">enthalpy_mole</span><span class="p">,</span> <span class="s1">&#39;J/kmol&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">moles_products</span>

<span class="n">heat</span> <span class="o">=</span> <span class="n">enthalpy_reactants</span> <span class="o">-</span> <span class="n">enthalpy_products</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Heat output: </span><span class="si">{</span><span class="n">heat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;MJ/kmol&quot;</span><span class="p">)</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Heat output: 661.44 megajoule / kilomole
</pre></div>
</div>
</div>
</div>
<p>This route is a bit simpler, and we get effectively the same value.</p>
</div>
<div class="section" id="calculate-efficiency">
<h3>Calculate efficiency<a class="headerlink" href="#calculate-efficiency" title="Permalink to this headline">¶</a></h3>
<p>Then, the First Law efficiency is based on either the lower or higher heating value of the fuel:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\eta_{\text{LHV}} = \frac{Q_{\text{out}}}{\text{LHV}} \\
\eta_{\text{HHV}} = \frac{Q_{\text{out}}}{\text{HHV}}
\end{split}\]</div>
<p>which we can find for methane based on tabulated information: LHV = 50,032 kJ/kg and HHV = 55,516 kJ/kg. (Or, we can calculate these values, as shown later: <span class="xref std std-doc">heating-values</span>.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">molecular_weight_methane</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">16.04</span><span class="p">,</span> <span class="s1">&#39;kg/kmol&#39;</span><span class="p">)</span>

<span class="n">heating_value_lower</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">50032</span><span class="p">,</span> <span class="s1">&#39;kJ/kg&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">molecular_weight_methane</span>
<span class="n">heating_value_higher</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">55516</span><span class="p">,</span> <span class="s1">&#39;kJ/kg&#39;</span><span class="p">)</span> <span class="o">*</span> <span class="n">molecular_weight_methane</span>

<span class="n">efficiency_lower</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">heat</span> <span class="o">/</span> <span class="n">heating_value_lower</span>
<span class="n">efficiency_higher</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">heat</span> <span class="o">/</span> <span class="n">heating_value_higher</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;First Law efficiencies:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; lower heating value: </span><span class="si">{</span><span class="n">to_si</span><span class="p">(</span><span class="n">efficiency_lower</span><span class="p">)</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39; higher heating value: </span><span class="si">{</span><span class="n">to_si</span><span class="p">(</span><span class="n">efficiency_higher</span><span class="p">)</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> %&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>First Law efficiencies:
 lower heating value:  82.42 %
 higher heating value:  74.28 %
</pre></div>
</div>
</div>
</div>
<p>The furnace appears very efficient from a first-law perspective.</p>
</div>
</div>
<div class="section" id="second-law-efficiency">
<h2>Second Law efficiency<a class="headerlink" href="#second-law-efficiency" title="Permalink to this headline">¶</a></h2>
<p>The Second Law efficiency is based on the exergy transfer of heat out of the system and the exergy transfer in from the fuel:</p>
<div class="math notranslate nohighlight">
\[
\eta_2 = \frac{X_{Q_{\text{out}}}}{X_{\text{fuel}}} \;,
\]</div>
<p>where the exergy flow due to heat transfer is</p>
<div class="math notranslate nohighlight">
\[
X_{Q_{\text{out}}} = Q_{\text{out}} \left(1 - \frac{T_0}{T_{\text{bldg}}} \right) \;.
\]</div>
<p>The dead state temperature is the temperature of the outdoor air.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">exergy_heat</span> <span class="o">=</span> <span class="n">heat</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">temperature_in</span> <span class="o">/</span> <span class="n">temperature_building</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Exergy of heat transfer: </span><span class="si">{</span><span class="n">exergy_heat</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s2">&quot;kJ/kmol&quot;</span><span class="p">)</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Exergy of heat transfer: 71712.94 kilojoule / kilomole
</pre></div>
</div>
</div>
</div>
<div class="section" id="exergy-of-a-fuel">
<span id="exergy-fuel"></span><h3>Exergy of a fuel<a class="headerlink" href="#exergy-of-a-fuel" title="Permalink to this headline">¶</a></h3>
<p>The exergy of the fuel is the maximum possible work obtainable by the fuel:</p>
<div class="math notranslate nohighlight">
\[
X_{\text{fuel}} = H_{\text{reac}} - H_{\text{prod}} - T_0 \left( S_{\text{reac}} - S_{\text{prod}} \right) \;,
\]</div>
<p>where <span class="math notranslate nohighlight">\(H_{\text{reac}}\)</span> and <span class="math notranslate nohighlight">\(H_{\text{prod}}\)</span> are the enthalpy of the reactants and products (per mole of fuel), and <span class="math notranslate nohighlight">\(S_{\text{reac}}\)</span> and <span class="math notranslate nohighlight">\(S_{\text{prod}}\)</span> are the entropy of the reactants and products (per mole of fuel); both are evaluated at the dead state temperature (<span class="math notranslate nohighlight">\(T_0\)</span>) and pressure. Furthermore, the entropy of each reactant/product is evaluated at its partial pressure.</p>
<p>If the dead state temperature is the same as the reference temperature, <span class="math notranslate nohighlight">\(T_0 = T_{\text{ref}}\)</span> = 25°C, then <span class="math notranslate nohighlight">\((H_{\text{reac}} - H_{\text{prod}})\)</span> will be bounded by the lower and higher heating values of the fuel, with the exact value depending on the dead state definition. (The term involving entropy is much smaller.)</p>
<p>Thus, the fuel exergy can be found in two ways:</p>
<ol class="simple">
<li><p>Approximate using the heating value, or <span class="math notranslate nohighlight">\(x_{\text{fuel}} \approx \text{HV}\)</span>.</p></li>
<li><p>Calculate based on the dead state conditions, or</p></li>
</ol>
<p>So, we can calculate the Second Law efficiency using the lower heating value (to be conservative):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">efficiency_second</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">to_si</span><span class="p">(</span><span class="n">exergy_heat</span> <span class="o">/</span> <span class="n">heating_value_lower</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Second Law efficiency (LHV): </span><span class="si">{</span><span class="n">efficiency_second</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Second Law efficiency (LHV):  8.94%
</pre></div>
</div>
</div>
</div>
<p>We can also <em>calculate</em> the exergy of the fuel, based on the specific dead state conditions here. To do this, we need to calculate the enthalpy and entropy of the reactants and products involved, per mole of fuel. These are</p>
<div class="math notranslate nohighlight">
\[\begin{split}
H = \sum_{i=1}^C n_i \overline{h}_{i, 0} (T_0) \quad \text{and} \\
S = \sum_{i=1}^C n_i \overline{s}_{i, 0} (T_0, P_i) \;, \\
\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is the number of components in the reactants or products, <span class="math notranslate nohighlight">\(n_i\)</span> is the stoichiometric coefficient for component <span class="math notranslate nohighlight">\(i\)</span> (i.e., the number of moles per mole of fuel), <span class="math notranslate nohighlight">\(\overline{h}_{i, 0}\)</span> is the molar specific enthalpy for component <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(\overline{s}_{i, 0}\)</span> is the molar specific entropy for component <span class="math notranslate nohighlight">\(i\)</span>, and <span class="math notranslate nohighlight">\(P_i\)</span> is the partial pressure of component <span class="math notranslate nohighlight">\(i\)</span>: <span class="math notranslate nohighlight">\(P_i = y_i P\)</span>.</p>
<p>To calculate the exergy of the fuel, we only <em>really</em> need to consider the components that actively participate in the chemical reaction, meaning the fuel, oxygen, carbon dioxide, and water. All other reactants and products, including the excess air, are at the same state before and after the reaction, and so do not contribute. However, for simplicity, we can include all reactants and products.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">gas</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;gri30.cti&#39;</span><span class="p">)</span>

<span class="n">enthalpies</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">entropies</span> <span class="o">=</span> <span class="p">{}</span>

<span class="n">moles_reactants</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span>

<span class="n">partial_pressure</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="n">moles_reactants</span><span class="p">)</span> <span class="o">*</span> <span class="n">pressure_in</span>
<span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">to_si</span><span class="p">(</span><span class="n">temperature_in</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">partial_pressure</span><span class="p">),</span> <span class="s1">&#39;CH4:1.0&#39;</span>
<span class="n">enthalpies</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">enthalpy_mole</span><span class="p">,</span> <span class="s1">&#39;J/kmol&#39;</span><span class="p">)</span>
<span class="n">entropies</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">entropy_mole</span><span class="p">,</span> <span class="s1">&#39;J/(K*kmol)&#39;</span><span class="p">)</span>

<span class="n">partial_pressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="n">moles_reactants</span><span class="p">)</span> <span class="o">*</span> <span class="n">pressure_in</span>
<span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">to_si</span><span class="p">(</span><span class="n">temperature_in</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">partial_pressure</span><span class="p">),</span> <span class="s1">&#39;O2:0.21, N2:0.79&#39;</span>
<span class="n">enthalpies</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">enthalpy_mole</span><span class="p">,</span> <span class="s1">&#39;J/kmol&#39;</span><span class="p">)</span>
<span class="n">entropies</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">entropy_mole</span><span class="p">,</span> <span class="s1">&#39;J/(K*kmol)&#39;</span><span class="p">)</span>

<span class="c1"># per kmol of fuel</span>
<span class="n">enthalpy_reactants</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">enthalpies</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">enthalpies</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span>
    <span class="p">)</span>
<span class="n">entropy_reactants</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">entropies</span><span class="p">[</span><span class="s1">&#39;CH4&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">coeffs</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">entropies</span><span class="p">[</span><span class="s1">&#39;air&#39;</span><span class="p">]</span>
    <span class="p">)</span>

<span class="n">moles_products</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="n">coeffs</span><span class="p">[</span><span class="n">c</span><span class="p">]</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">products</span><span class="p">])</span>
<span class="k">for</span> <span class="n">product</span> <span class="ow">in</span> <span class="n">products</span><span class="p">:</span>
    <span class="n">partial_pressure</span> <span class="o">=</span> <span class="p">(</span><span class="n">coeffs</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">/</span> <span class="n">moles_products</span><span class="p">)</span> <span class="o">*</span> <span class="n">pressure_in</span>
    <span class="n">gas</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">to_si</span><span class="p">(</span><span class="n">temperature_in</span><span class="p">),</span> <span class="n">to_si</span><span class="p">(</span><span class="n">partial_pressure</span><span class="p">),</span> 
        <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">product</span><span class="si">}</span><span class="s1">:1.0&#39;</span>
        <span class="p">)</span>
    <span class="n">enthalpies</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">enthalpy_mole</span><span class="p">,</span> <span class="s1">&#39;J/kmol&#39;</span><span class="p">)</span>
    <span class="n">entropies</span><span class="p">[</span><span class="n">product</span><span class="p">]</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">gas</span><span class="o">.</span><span class="n">entropy_mole</span><span class="p">,</span> <span class="s1">&#39;J/(K*kmol)&#39;</span><span class="p">)</span>

<span class="c1"># per kmol of fuel</span>
<span class="n">enthalpy_products</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span>
    <span class="n">coeffs</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">*</span> <span class="n">enthalpies</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">products</span>
    <span class="p">])</span>
<span class="n">entropy_products</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span>
    <span class="n">coeffs</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="o">*</span> <span class="n">entropies</span><span class="p">[</span><span class="n">p</span><span class="p">]</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">products</span>
    <span class="p">])</span>

<span class="n">exergy_fuel</span> <span class="o">=</span> <span class="p">(</span>
    <span class="n">enthalpy_reactants</span> <span class="o">-</span> <span class="n">enthalpy_products</span> <span class="o">-</span> 
    <span class="n">temperature_in</span> <span class="o">*</span> <span class="p">(</span><span class="n">entropy_reactants</span> <span class="o">-</span> <span class="n">entropy_products</span><span class="p">)</span>
    <span class="p">)</span>

<span class="n">efficiency_second</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">*</span> <span class="n">to_si</span><span class="p">(</span><span class="n">exergy_heat</span> <span class="o">/</span> <span class="n">exergy_fuel</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Second Law efficiency: </span><span class="si">{</span><span class="n">efficiency_second</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-none notranslate"><div class="highlight"><pre><span></span>Second Law efficiency:  8.86%
</pre></div>
</div>
</div>
</div>
<p>We get a similar, but slightly lower, Second Law efficiency when calculating it based on the more-correct exergy of the fuel.</p>
<p>Either way, we see that the efficiency of this furnace is quite low from a Second Law perspective, due to the significant exergy leaving with the exhaust.</p>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "kyleniemeyer/computational-thermo",
            ref: "newbackend",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "content/combustion"
        }
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="adiabatic-flame-temperature.html" title="previous page">Adiabatic flame temperature</a>
    <a class='right-next' id="next-link" href="../chemical-equilibrium/chemical-equilibrium.html" title="next page">Chemical Equilibrium</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Kyle Niemeyer<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    <script src="../../_static/js/index.js"></script>
    
  </body>
</html>