---
interact_link: content/intro-solving-problems.ipynb
kernel_name: python3
kernel_path: content
has_widgets: false
title: |-
  Solving thermodynamics problems
pagenum: 2
prev_page:
  url: /setting-up-environment.html
next_page:
  url: /first-law/first-law.html
suffix: .ipynb
search: ct cantera units properties pint problems need thermodynamic thermodynamics also fluids expressions e g state solving module using coolprop org setting unit between different involving quantities temperature pressure convert si kelvin k object nitrogen methane hydrogen oxygen heptane ra lets any introduces solve python briefly show used access wider range currently supports help running examples own computing environment import necessary libraries quick intro useful tool parsing converting working values example read give us customary imperial those interprets nearly either written meters abbreviations m except temperatures case celsius degc fahrenheits degf rankine degr another specify multiply value member ureg handles mathematical

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Solving thermodynamics problems</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This module introduces how to solve thermodynamics problems in Python using Cantera and Pint. It will also briefly show how <a href="http://coolprop.org">CoolProp</a> could also be used, if you need access to a wider range of fluids than Cantera currently supports.</p>
<p>For help running these examples or setting up your own problems, see the module on "Setting up your computing environment".</p>
<p>First, we need to import the necessary libraries:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Numpy adds some useful numerical types and functions</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Cantera will handle thermodynamic properties</span>
<span class="kn">import</span> <span class="nn">cantera</span> <span class="k">as</span> <span class="nn">ct</span>

<span class="c1"># Pint gives us some helpful unit conversion</span>
<span class="kn">from</span> <span class="nn">pint</span> <span class="kn">import</span> <span class="n">UnitRegistry</span>
<span class="n">ureg</span> <span class="o">=</span> <span class="n">UnitRegistry</span><span class="p">()</span>
<span class="n">Q_</span> <span class="o">=</span> <span class="n">ureg</span><span class="o">.</span><span class="n">Quantity</span> <span class="c1"># We will use this to construct quantities (value + unit)</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Quick-Pint-intro">Quick Pint intro<a class="anchor-link" href="#Quick-Pint-intro"> </a></h2><p>Pint is a useful tool for parsing unit expressions, converting between different units, and working with expressions involving quantities (values + units).</p>
<p>For example, we can read in expressions that give temperature and pressure in US customary units (e.g., imperial units) and then convert those to SI units:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell tag_popout">

<div class="cell border-box-sizing text_cell rendered tag_popout"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pint interprets nearly all properties either written out (e.g., <code>kelvin</code>, <code>meters</code>) or as abbreviations (e.g., <code>K</code>, <code>m</code>)â€”except for temperatures. In that case, we need to use <code>kelvin</code> or <code>K</code>, <code>celsius</code> or <code>degC</code>, <code>fahrenheits</code> or <code>degF</code>, and <code>rankine</code> or <code>degR</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temperature</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="s1">&#39;degF&#39;</span><span class="p">)</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="s1">&#39;10 psi&#39;</span><span class="p">)</span>

<span class="n">new_temperature</span> <span class="o">=</span> <span class="n">temperature</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="n">new_pressure</span> <span class="o">=</span> <span class="n">pressure</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Temperature in SI: </span><span class="si">{</span><span class="n">new_temperature</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Pressure in SI: </span><span class="si">{</span><span class="n">new_pressure</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Temperature in SI: 310.93 kelvin
Pressure in SI: 68947.57 pascal
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Another way to specify units is to multiply the value by an object with the unit (as a member of the <code>ureg</code> object):</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distance</span> <span class="o">=</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">ureg</span><span class="o">.</span><span class="n">meter</span>
<span class="nb">print</span><span class="p">(</span><span class="n">distance</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>10 meter
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Pint also handles mathematical operations between physical quantities:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">distance1</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;m&#39;</span><span class="p">)</span>
<span class="n">distance2</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">distance1</span> <span class="o">+</span> <span class="n">distance2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>1.1 meter
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mass</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="s1">&#39;kg&#39;</span><span class="p">)</span>
<span class="n">velocity</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;m/s&#39;</span><span class="p">)</span>
<span class="n">kinetic_energy</span> <span class="o">=</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">mass</span> <span class="o">*</span> <span class="n">velocity</span><span class="o">**</span><span class="mi">2</span>

<span class="nb">print</span><span class="p">(</span><span class="n">kinetic_energy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">kinetic_energy</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;joule&#39;</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>2.0 kilogram * meter ** 2 / second ** 2
2.0 joule
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Using-Cantera-for-thermodynamic-properties">Using Cantera for thermodynamic properties<a class="anchor-link" href="#Using-Cantera-for-thermodynamic-properties"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><a href="https://cantera.org">Cantera</a> is a suite of tools for solving problems involving chemical kinetics, thermodynamics, and transport processes. We'll use it here primarily for evaluating thermodynamic properties of fluids.</p>
<p>Cantera comes with built-in liquid/vapor equations of state for multiple fluids:</p>
<ul>
<li>water: <code>ct.Water()</code></li>
<li>nitrogen: <code>ct.Nitrogen()</code></li>
<li>methane: <code>ct.Methane()</code></li>
<li>hydrogen (H2): <code>ct.Hydrogen()</code></li>
<li>oxygen (O2): <code>ct.Oxygen()</code></li>
<li>carbon dioxide (CO2): <code>ct.CarbonDioxide()</code></li>
<li>n-heptane (C7H16): <code>ct.Heptane()</code></li>
<li>R134a: <code>ct.Hfc134a()</code></li>
</ul>
<p>Let's take a look at water, and evaluate its properties at different conditions:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># Create an object to hold the thermodynamic state of water</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Water</span><span class="p">()</span>

<span class="c1"># Fix the thermodynamic state by specifying temperature and </span>
<span class="c1"># specific volume, in SI units (K and m^3/kg)</span>
<span class="n">f</span><span class="o">.</span><span class="n">TV</span> <span class="o">=</span> <span class="mf">673.15</span><span class="p">,</span> <span class="mf">1e-2</span>

<span class="c1"># Evaluating the object provides a summary of its properties at this state</span>
<span class="n">f</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
  water:

       temperature          673.15  K
          pressure     1.99362e+07  Pa
           density             100  kg/m^3
  mean mol. weight          18.016  amu
    vapor fraction               1

                          1 kg            1 kmol
                       -----------      ------------
          enthalpy    -1.31504e+07       -2.369e+08     J
   internal energy    -1.33497e+07       -2.405e+08     J
           entropy         9078.37        1.636e+05     J/K
    Gibbs function    -1.92615e+07        -3.47e+08     J
 heat capacity c_p         6284.65        1.132e+05     J/K
 heat capacity c_v         2693.99        4.853e+04     J/K

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can do the same thing to get the properties of R134a; this time, let's use Pint to interpret the temperature and pressure as given in units of Â°C and bar, then convert to SI as needed by Cantera:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">f</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Hfc134a</span><span class="p">()</span>

<span class="c1"># Specify temperature and pressure</span>
<span class="n">temp</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;degC&#39;</span><span class="p">)</span>
<span class="n">pres</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;bar&#39;</span><span class="p">)</span>

<span class="c1"># Fix the thermodynamic state using temperature and pressure</span>
<span class="c1"># Remember, Cantera requires SI units</span>
<span class="n">f</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">temp</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">pres</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span>

<span class="c1"># see overview of properties</span>
<span class="n">f</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>
  hfc134a:

       temperature          323.15  K
          pressure          300000  Pa
           density         11.9442  kg/m^3
  mean mol. weight         102.032  amu
    vapor fraction               1

                          1 kg            1 kmol
                       -----------      ------------
          enthalpy          243187        2.481e+07     J
   internal energy          218070        2.225e+07     J
           entropy         1607.36         1.64e+05     J/K
    Gibbs function         -276232       -2.818e+07     J
 heat capacity c_p         917.046        9.357e+04     J/K
 heat capacity c_v         813.222        8.297e+04     J/K

</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Once we have the thermodynamic state fixed for a fluid, we can easily obtain any properties we need:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># get internal energy in SI units (mass basis)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Internal energy: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">u</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> J/kg&#39;</span><span class="p">)</span>

<span class="c1"># enthalpy</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Enthalpy: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">h</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> J/kg&#39;</span><span class="p">)</span>

<span class="c1"># constant pressure specific heat</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;c_p: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">cp</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> J&#39;</span><span class="p">)</span>
<span class="c1"># constant volume specific heat</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;c_v: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">cv</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> J&#39;</span><span class="p">)</span>

<span class="c1"># density</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;density: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">density</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> kg/m^3&#39;</span><span class="p">)</span>

<span class="c1"># critical properties</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;critical temperature: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">critical_temperature</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> K&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;critical pressure: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">critical_pressure</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> Pa&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;critical density: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">critical_density</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1"> kg/m^3&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Internal energy:  218070.47 J/kg
Enthalpy:  243187.37 J/kg
c_p:  917.05 J
c_v:  813.22 J
density:  11.94 kg/m^3
critical temperature:  374.21 K
critical pressure:  4059280.00 Pa
critical density:  511.95 kg/m^3
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can fix the thermodynamic state by any combination of two properties:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># specify pressure and internal enegy</span>
<span class="n">pres</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">250e3</span><span class="p">,</span> <span class="s1">&#39;Pa&#39;</span><span class="p">)</span>
<span class="n">internal_energy</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mf">300e3</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">UP</span> <span class="o">=</span> <span class="n">internal_energy</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;J/kg&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">pres</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span>

<span class="c1"># get specific volume</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Specific volume: </span><span class="si">{</span><span class="n">f</span><span class="o">.</span><span class="n">v</span><span class="si">:</span><span class="s1"> 0.4f</span><span class="si">}</span><span class="s1"> m^3/kg&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Specific volume:  0.1332 m^3/kg
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Compare-ideal-and-real-gas-behavior-for-air">Compare ideal and real gas behavior for air<a class="anchor-link" href="#Compare-ideal-and-real-gas-behavior-for-air"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">temp1</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="n">temp2</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">1270</span><span class="p">,</span> <span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="n">pres</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span> <span class="s1">&#39;kPa&#39;</span><span class="p">)</span>

<span class="c1"># Real gas</span>
<span class="n">air_real1</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Nitrogen</span><span class="p">()</span>
<span class="n">air_real1</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span> <span class="n">temp1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">pres</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span> 

<span class="n">air_real2</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Nitrogen</span><span class="p">()</span>
<span class="n">air_real2</span><span class="o">.</span><span class="n">TP</span> <span class="o">=</span>  <span class="n">temp2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">pres</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span> 

<span class="n">delta_u_real</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">air_real2</span><span class="o">.</span><span class="n">u</span> <span class="o">-</span> <span class="n">air_real1</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Î”u for real gas: </span><span class="si">{</span><span class="n">delta_u_real</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="c1"># ideal gas</span>
<span class="n">air_ideal1</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;air.cti&#39;</span><span class="p">)</span>
<span class="n">air_ideal1</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">temp1</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">pres</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s1">&#39;N2:1.0&#39;</span>

<span class="n">air_ideal2</span> <span class="o">=</span> <span class="n">ct</span><span class="o">.</span><span class="n">Solution</span><span class="p">(</span><span class="s1">&#39;air.cti&#39;</span><span class="p">)</span>
<span class="n">air_ideal2</span><span class="o">.</span><span class="n">TPX</span> <span class="o">=</span> <span class="n">temp2</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;K&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="n">pres</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;Pa&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">magnitude</span><span class="p">,</span> <span class="s1">&#39;N2:1.0&#39;</span>

<span class="n">delta_u_ideal</span> <span class="o">=</span> <span class="n">Q_</span><span class="p">(</span><span class="n">air_ideal2</span><span class="o">.</span><span class="n">u</span> <span class="o">-</span> <span class="n">air_ideal1</span><span class="o">.</span><span class="n">u</span><span class="p">,</span> <span class="s1">&#39;J/kg&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Î”u for ideal gas: </span><span class="si">{</span><span class="n">delta_u_ideal</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

<span class="n">diff</span> <span class="o">=</span> <span class="mi">100</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">delta_u_ideal</span><span class="o">-</span><span class="n">delta_u_real</span><span class="p">)</span><span class="o">/</span><span class="n">delta_u_real</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;difference: </span><span class="si">{</span><span class="n">diff</span><span class="o">.</span><span class="n">magnitude</span><span class="si">:</span><span class="s1"> .2f</span><span class="si">}</span><span class="s1">%&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Î”u for real gas: 647294.70 joule / kilogram
Î”u for ideal gas: 648472.39 joule / kilogram
difference:  0.18%
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

 


    </main>
    